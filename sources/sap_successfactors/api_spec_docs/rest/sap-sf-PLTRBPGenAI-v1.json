{
  "openapi": "3.0.2",
  "info": {
    "title": "Role-Based Permissions Generative AI Troubleshooting",
    "description": "Provides Gen-AI based functions to support Role-Based Permissions (RBP) troubleshooting. You can use this REST API to search for RBP permissions and permission groups, query all role names for a specific access group, and modify the members of a static group, etc.\n\n You can find your company's API server in [List of API Servers in SAP SuccessFactors.](https://help.sap.com/viewer/d599f15995d348a1b45ba5603e2aba9b/LATEST/en-US/af2b8d5437494b12be88fe374eba75b6.html)",
    "version": "1.0.0"
  },
  "externalDocs": {
    "description": "RBP Troubleshooting SAP Help Portal",
    "url": "https://help.sap.com/docs/successfactors-platform/implementing-role-based-permissions/role-based-permissions-troubleshooting-tool"
  },
  "x-sap-api-type": "REST",
  "x-sap-shortText": "Query permission groups and roles, etc.",
  "servers": [
    {
      "url": "https://{api-server}/rest/iam/authorization/genai/v1",
      "description": "Rest APIs for RBP troubleshooting",
      "variables": {
        "api-server": {
          "description": "RBP troubleshooting rest api host.",
          "default": "apisalesdemo4.successfactors.com"
        }
      }
    },
    {
      "url": "https://sandbox.api.sap.com/successfactorsfoundation",
      "description": "Sandbox Server"
    }
  ],
  "paths": {
    "/rest/iam/authorization/genai/v1/permissions": {
      "post": {
        "parameters": [
          {
            "name": "userName",
            "in": "query",
            "description": "The name of a user.",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "cgrant"
          },
          {
            "name": "keyWords",
            "in": "query",
            "description": "keyWords used to search for the RBP permissions.",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "user_login"
          },
          {
            "name": "Accept-Language",
            "in": "header",
            "description": "The preferred language for the response, for example, 'en_US' stands for American English. The default value is 'en_US'.",
            "required": false,
            "schema": {
              "type": "string"
            },
            "example": "en_US"
          }
        ],
        "responses": {
          "200": {
            "description": "Returns a successful response that includes up to 5 permissions and a flag indicating if there are additional results available.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PermissionsResponse"
                },
                "example": {
                  "permissions": [
                    {
                      "permissionId": 55,
                      "permissionLabel": "user_login",
                      "granted": true
                    }
                  ],
                  "hasMore": false
                }
              }
            }
          },
          "400": {
            "description": "Bad request. Possible reasons include security check failures or illegal characters in the request.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 400,
                  "message": "Bad request. Possible reasons: security check failures or illegal characters in the request."
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. The request lacks valid authentication credentials.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 401,
                  "message": "Unauthorized. The request lacks valid authentication credentials."
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error. An unexpected error occurred on the server.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 500,
                  "message": "Internal Server Error. An unexpected error occurred on the server."
                }
              }
            }
          }
        },
        "summary": "Queries and returns up to 5 permissions, each including the permission label and the granted status for a given user. Required parameters include 'userName' and 'keyWords'.",
        "description": "Use this POST API to query RBP permissions. Three parameters are required: 'userName', which indicates the input user name; 'keywords', which indicates the keywords used to search for RBP permissions; the optional 'Accept-Language' header, which specifies the preferred language for the response. The API will return up to 5 permissions, each containing a 'permissionId', 'permissionLabel', and the 'granted' status. The 'hasMore' field in the response indicates whether there are more permissions available beyond the returned results. If the request is successful, a 200 status code will be returned with the permission details. A 400 status code indicates a bad request, which could be caused by security check failures or illegal characters in the request. A 401 status code indicates an unauthorized request.",
        "tags": [
          "Permissions"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PermissionsRequest"
              },
              "example": {
                "userName": "cgrant",
                "keyWords": "user_login"
              }
            }
          }
        }
      }
    },
    "/rest/iam/authorization/genai/v1/groups": {
      "post": {
        "parameters": [
          {
            "name": "permissionId",
            "in": "query",
            "description": "The RBP permission ID",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "example": 123
          },
          {
            "name": "isPermissionBased",
            "in": "query",
            "description": "Indicates whether it is a permission group.",
            "required": true,
            "schema": {
              "type": "boolean"
            },
            "example": true
          }
        ],
        "responses": {
          "200": {
            "description": "Returns up to 5 permissions groups. Static groups take precedence over dynamic groups.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GroupsResponse"
                },
                "example": {
                  "staticGroups": [
                    {
                      "groupId": 1,
                      "groupName": "StaticGroupWithAllKindsOfUsers"
                    }
                  ],
                  "dynamicGroups": [
                    {
                      "groupId": 2,
                      "groupName": "DynamicGroup"
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Bad request. Invalid inputs.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 400,
                  "message": "Bad request. Invalid inputs."
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. The request lacks valid authentication credentials.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 401,
                  "message": "Unauthorized. The request lacks valid authentication credentials."
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error. An unexpected error occurred on the server.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 500,
                  "message": "Internal Server Error. An unexpected error occurred on the server."
                }
              }
            }
          }
        },
        "summary": "Queries and returns up to permission groups based on the given permission ID, group type, and group name. Static groups take precedence over dynamic groups.",
        "description": "Use this POST API to query groups. Three parameters are required: 'permissionId', which is the RBP permission ID'; 'isPermissionBased', which indicates whether it is a permission-based group; 'groupName', which is the input group name. The API returns up to 5 permission groups, with static groups taking precedence over dynamic groups. If the request is successful, you receive a 200 status code with the group details. A 400 status code indicates a bad request due to invalid inputs. A 401 status code means the request is unauthorized. A 500 status code indicates an internal server error.",
        "tags": [
          "Groups"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GroupsRequest"
              },
              "example": {
                "permissionId": 123,
                "isPermissionBased": true
              }
            }
          }
        }
      }
    },
    "/rest/iam/authorization/genai/v1/roles": {
      "get": {
        "parameters": [
          {
            "name": "groupId",
            "in": "query",
            "description": "The ID of a permission group.",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "1L"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved role names for the given group ID.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleResponse"
                },
                "example": {
                  "value": [
                    "roleA",
                    "roleB",
                    "roleC",
                    "roleD"
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Bad Request. Possible reasons include invalid group ID.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 400,
                  "message": "Bad request. Invalid group ID."
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. The request lacks valid authentication credentials.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 401,
                  "message": "Unauthorized. The request lacks valid authentication credentials."
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error. An unexpected error occurred on the server.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 500,
                  "message": "Internal Server Error. An unexpected error occurred on the server."
                }
              }
            }
          }
        },
        "summary": "Query all role names based on the access group.",
        "description": "Use this GET API to query all role names for a specific access group. One parameter is required: 'groupId', which represents the ID of the group you want to query.",
        "tags": [
          "Roles"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RoleRequest"
              },
              "example": {
                "groupId": 123
              }
            }
          }
        }
      }
    },
    "/staticGroups/{groupId}": {
      "patch": {
        "summary": "Modify static group members",
        "tags": [
          "Static Groups"
        ],
        "parameters": [
          {
            "name": "groupId",
            "in": "path",
            "description": "The ID of the static group to modify.",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "1L"
          },
          {
            "name": "Accept-Language",
            "in": "header",
            "description": "The preferred language for the response, for example, 'en_US' stands for American English. The default value is 'en_US'.",
            "required": false,
            "schema": {
              "type": "string"
            },
            "example": "en_US"
          },
          {
            "name": "members",
            "in": "path",
            "description": "The list of members to include in the group.",
            "required": true,
            "schema": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string"
                  }
                }
              }
            },
            "example": [
              {
                "id": "member1"
              },
              {
                "id": "member2"
              },
              {
                "id": "member3"
              }
            ]
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully modified the static group members.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StaticGroupResponse"
                },
                "example": "true"
              }
            }
          },
          "400": {
            "description": "Bad request. Invalid group ID or invalid list of member IDs.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 400
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. The request lacks valid authentication credentials.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "errorCode": 401
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "PermissionsRequest": {
        "type": "object",
        "properties": {
          "userName": {
            "type": "string",
            "description": "The input user name used to query permissions."
          },
          "keyWords": {
            "type": "string",
            "description": "keyWords used to search for RBP permissions."
          }
        },
        "required": [
          "userName",
          "keyWords"
        ]
      },
      "PermissionsResponse": {
        "type": "object",
        "properties": {
          "permissions": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "permissionId": {
                  "type": "integer",
                  "description": "The RBP permission ID."
                },
                "permissionLabel": {
                  "type": "string",
                  "description": "The label of the permission."
                },
                "granted": {
                  "type": "boolean",
                  "description": "Indicates whether it is a permission group."
                }
              }
            },
            "description": "List of permission details."
          },
          "hasMore": {
            "type": "boolean",
            "description": "Indicates whether there are more permissions available beyond the returned results."
          }
        }
      },
      "GroupsRequest": {
        "type": "object",
        "properties": {
          "permissionId": {
            "type": "integer",
            "description": "The RBP permission ID."
          },
          "isPermissionBased": {
            "type": "boolean",
            "description": "Indicates whether it is a permission group."
          }
        },
        "required": [
          "permissionId",
          "isPermissionBased"
        ]
      },
      "GroupsResponse": {
        "type": "object",
        "properties": {
          "staticGroups": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "groupId": {
                  "type": "integer",
                  "description": "The ID of a permission group."
                },
                "groupName": {
                  "type": "string",
                  "description": "The name of the static group."
                }
              }
            },
            "description": "List of top 5 static groups."
          },
          "dynamicGroups": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "groupId": {
                  "type": "integer",
                  "description": "The unique identifier of the dynamic group."
                },
                "groupName": {
                  "type": "string",
                  "description": "The name of the dynamic group."
                }
              }
            },
            "description": "List of top 5 dynamic groups."
          }
        }
      },
      "RoleRequest": {
        "type": "object",
        "properties": {
          "groupId": {
            "type": "integer",
            "description": "The ID of a permission group."
          }
        },
        "required": [
          "groupId"
        ]
      },
      "RoleResponse": {
        "type": "object",
        "properties": {
          "value": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of role names associated with the given group ID."
          }
        }
      },
      "StaticGroupRequest": {
        "type": "object",
        "properties": {
          "members": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "StaticGroupResponse": {
        "type": "boolean"
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "errorCode": {
            "type": "integer",
            "description": "The HTTP error code."
          },
          "message": {
            "type": "string",
            "description": "A description of the error."
          }
        }
      }
    },
    "parameters": {},
    "responses": {},
    "securitySchemes": {
      "BasicAuth": {
        "type": "http",
        "scheme": "basic"
      }
    }
  },
  "security": [
    {
      "BasicAuth": []
    }
  ]
}
